<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Refresh sparse items</title>
</head>
<body>
    <div data-role="page" class="page type-interior pluginConfigurationPage configPage" data-require="emby-input,emby-button,emby-select,emby-checkbox">
        <div data-role="content">
            <div class="content-primary">
                <form class="configForm">
                    <fieldset class="verticalSection">
                        <legend>
                            <h3>General</h3>
                        </legend>
                        <div class="inputContainer">
                            <label class="inputeLabel inputLabelUnfocused" for="SeriesBlockList">Series Block List</label>
                            <input id="SeriesBlockList" name="SeriesBlockList" type="text" is="emby-input" />
                            <div class="fieldDescription">| separated list of series to not check</div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="Pretend" name="Pretend" type="checkbox" is="emby-checkbox" />
                                <span>Don't actually refresh items. Useful for debugging. Check logs to see what would be updated.</span>
                            </label>
                        </div>
                    </fieldset>

                    <fieldset class="verticalSection">
                        <legend>
                            <h3>Episodes</h3>
                        </legend>
                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="MaxDays">Maximum days</label>
                            <input id="MaxDays" name="MaxDays" type="number" is="emby-input" min="-1" />
                            <div class="fieldDescription">Max age of episode, based on premiere date. -1 to disable and always check.</div>
                        </div>
                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="RefreshCooldownMinutes">Refresh cooldown</label>
                            <input id="RefreshCooldownMinutes" name="RefreshCooldownMinutes" type="number" is="emby-input" min="-1" />
                            <div class="fieldDescription">Don't refresh episode if already refreshed within X minutes. -1 to disable</div>
                        </div>
                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="MinimumProviderIds">Minimum provider IDs</label>
                            <input id="MinimumProviderIds" name="MinimumProviderIds" type="number" is="emby-input" min="0" />
                            <div class="fieldDescription">Minimum number of external provider IDs</div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="MissingOverview" name="MissingOverview" type="checkbox" is="emby-checkbox" />
                                <span>Missing overview</span>
                            </label>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="MissingImage" name="MissingImage" type="checkbox" is="emby-checkbox" />
                                <span>Missing image</span>
                            </label>
                        </div>
                        <fieldset class="verticalSection verticalSection-extrabottompadding">
                            <legend>
                                <h3>Name</h3>
                            </legend>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input id="MissingName" name="MissingName" type="checkbox" is="emby-checkbox" />
                                    <span>Missing name</span>
                                </label>
                            </div>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input id="NameIsDate" name="NameIsDate" type="checkbox" is="emby-checkbox" />
                                    <span>Name is a date. Example "January 1, 2022"</span>
                                </label>
                            </div>
                            <div class="inputContainer">
                                <label class="inputeLabel inputLabelUnfocused" for="BadNames">Bad names list</label>
                                <input id="BadNames" name="BadNames" type="text" is="emby-input" />
                                <div class="fieldDescription">| separated list of placeholder names. Example "Episode |TBA"</div>
                            </div>
                            <div class="checkboxContainer checkboxContainer-withDescription">
                                <label class="emby-checkbox-label">
                                    <input id="OverviewBadName" name="OverviewBadName" type="checkbox" is="emby-checkbox" />
                                    <span>Check if overview contains a bad name</span>
                                </label>
                            </div>
                        </fieldset>

                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="ReplaceAllMetadata" name="ReplaceAllMetadata" type="checkbox" is="emby-checkbox" />
                                <span>Replace all metadata</span>
                            </label>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="ReplaceAllImages" name="ReplaceAllImages" type="checkbox" is="emby-checkbox" />
                                <span>Replace all images</span>
                            </label>
                        </div>
                    </fieldset>

                    <fieldset class="verticalSection">
                        <legend>
                            <h3>Series</h3>
                        </legend>

                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="SeriesStatusDays">Status</label>
                            <input id="SeriesStatusDays" name="SeriesStatusDays" type="number" is="emby-input" min="-1" />
                            <div class="fieldDescription">Check every X days if continuing series has ended. -1 to disable and never check.
                            </div>
                        </div>

                        <div class="inputContainer">
                            <label class="inputLabel inputLabelUnfocused" for="SeriesMinimumProviderIds">Minimum provider IDs</label>
                            <input id="SeriesMinimumProviderIds" name="SeriesMinimumProviderIds" type="number" is="emby-input" min="0" />
                            <div class="fieldDescription">Minimum number of external provider IDs</div>
                        </div>

                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="SeriesOverview" name="SeriesOverview" type="checkbox" is="emby-checkbox" />
                                <span>Missing overview</span>
                            </label>
                        </div>

                        <div>
                            <h3 class="checkboxListLabel">Missing Images</h3>
                            <div class="paperList checkboxList checkboxList-paperList" id="SeriesImagesList">
                                <label class="emby-checkbox-label">
                                    <input id="SeriesPrimary" name="SeriesPrimary" type="checkbox" is="emby-checkbox" />
                                    <span>Primary</span>
                                </label>
                                <label class="emby-checkbox-label">
                                    <input id="SeriesArt" name="SeriesArt" type="checkbox" is="emby-checkbox" />
                                    <span>Clearart</span>
                                </label>
                                <label class="emby-checkbox-label">
                                    <input id="SeriesBanner" name="SeriesBanner" type="checkbox" is="emby-checkbox" />
                                    <span>Banner</span>
                                </label>
                                <label class="emby-checkbox-label">
                                    <input id="SeriesLogo" name="SeriesLogo" type="checkbox" is="emby-checkbox" />
                                    <span>Logo</span>
                                </label>
                                <label class="emby-checkbox-label">
                                    <input id="SeriesThumb" name="SeriesThumb" type="checkbox" is="emby-checkbox" />
                                    <span>Thumb</span>
                                </label>
                                <label class="emby-checkbox-label">
                                    <input id="SeriesBackdrop" name="SeriesBackdrop" type="checkbox" is="emby-checkbox" />
                                    <span>Backdrop</span>
                                </label>
                            </div>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="SeriesReplaceAllMetadata" name="SeriesReplaceAllMetadata" type="checkbox" is="emby-checkbox" />
                                <span>Replace all metadata</span>
                            </label>
                        </div>
                        <div class="checkboxContainer checkboxContainer-withDescription">
                            <label class="emby-checkbox-label">
                                <input id="SeriesReplaceAllImages" name="SeriesReplaceAllImages" type="checkbox" is="emby-checkbox" />
                                <span>Replace all images</span>
                            </label>
                        </div>
                    </fieldset>


                    <div>
                        <button is="emby-button" type="submit" class="raised button-submit block emby-button">
                            <span>Save</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>
        <script type="text/javascript">
            var RefreshSparseConfig = {
                pluginUniqueId: '12b44f20-6cfb-4be5-9950-3d0fbe74fa35'
            };

            document.querySelector('.configPage')
                .addEventListener('pageshow', function() {
                    Dashboard.showLoadingMsg();
                    ApiClient.getPluginConfiguration(RefreshSparseConfig.pluginUniqueId).then(function (config) {
                        // general
                        document.querySelector('#SeriesBlockList').value = config.SeriesBlockList;
                        document.querySelector('#Pretend').checked = config.Pretend;

                        // episodes
                        document.querySelector('#MinimumProviderIds').value = config.MinimumProviderIds;
                        document.querySelector('#MaxDays').value = config.MaxDays;
                        document.querySelector('#MissingImage').checked = config.MissingImage;
                        document.querySelector('#MissingName').checked = config.MissingName;
                        document.querySelector('#MissingOverview').checked = config.MissingOverview;
                        document.querySelector('#NameIsDate').checked = config.NameIsDate;
                        document.querySelector('#BadNames').value = config.BadNames;
                        document.querySelector('#OverviewBadName').checked = config.OverviewBadName;
                        document.querySelector('#RefreshCooldownMinutes').value = config.RefreshCooldownMinutes;
                        document.querySelector('#ReplaceAllImages').checked = config.ReplaceAllImages;
                        document.querySelector('#ReplaceAllMetadata').checked = config.ReplaceAllMetadata;

                        // series
                        document.querySelector('#SeriesStatusDays').value = config.SeriesStatusDays;
                        document.querySelector('#SeriesMinimumProviderIds').value = config.SeriesMinimumProviderIds;
                        document.querySelector('#SeriesOverview').checked = config.SeriesOverview;

                        document.querySelector('#SeriesPrimary').checked = config.SeriesPrimary;
                        document.querySelector('#SeriesArt').checked = config.SeriesArt;
                        document.querySelector('#SeriesBanner').checked = config.SeriesBanner;
                        document.querySelector('#SeriesLogo').checked = config.SeriesLogo;
                        document.querySelector('#SeriesThumb').checked = config.SeriesThumb;
                        document.querySelector('#SeriesBackdrop').checked = config.SeriesBackdrop;

                        document.querySelector('#SeriesReplaceAllImages').checked = config.SeriesReplaceAllImages;
                        document.querySelector('#SeriesReplaceAllMetadata').checked = config.SeriesReplaceAllMetadata;

                        Dashboard.hideLoadingMsg();
                    });
                });

            document.querySelector('.configForm')
                .addEventListener('submit', function(e) {
                Dashboard.showLoadingMsg();
                ApiClient.getPluginConfiguration(RefreshSparseConfig.pluginUniqueId).then(function (config) {
                    // general
                    config.SeriesBlockList = document.querySelector('#SeriesBlockList').value;
                    config.Pretend = document.querySelector('#Pretend').checked;

                    // episodes
                    config.MaxDays = document.querySelector('#MaxDays').value;
                    config.MinimumProviderIds = document.querySelector('#MinimumProviderIds').value;
                    config.MissingImage = document.querySelector('#MissingImage').checked;
                    config.MissingName = document.querySelector('#MissingName').checked;
                    config.MissingOverview = document.querySelector('#MissingOverview').checked;
                    config.NameIsDate = document.querySelector('#NameIsDate').checked;
                    config.BadNames = document.querySelector('#BadNames').value;
                    config.OverviewBadName = document.querySelector('#OverviewBadName').checked;
                    config.RefreshCooldownMinutes = document.querySelector('#RefreshCooldownMinutes').value;
                    config.ReplaceAllImages = document.querySelector('#ReplaceAllImages').checked;
                    config.ReplaceAllMetadata = document.querySelector('#ReplaceAllMetadata').checked;

                    // series
                    config.SeriesStatusDays = document.querySelector('#SeriesStatusDays').value;
                    config.SeriesMinimumProviderIds = document.querySelector('#SeriesMinimumProviderIds').value;
                    config.SeriesOverview = document.querySelector('#SeriesOverview').checked;

                    config.SeriesPrimary = document.querySelector('#SeriesPrimary').checked;
                    config.SeriesArt = document.querySelector('#SeriesArt').checked;
                    config.SeriesBanner = document.querySelector('#SeriesBanner').checked;
                    config.SeriesLogo = document.querySelector('#SeriesLogo').checked;
                    config.SeriesThumb = document.querySelector('#SeriesThumb').checked;
                    config.SeriesBackdrop = document.querySelector('#SeriesBackdrop').checked;

                    config.SeriesReplaceAllImages = document.querySelector('#SeriesReplaceAllImages').checked;
                    config.SeriesReplaceAllMetadata = document.querySelector('#SeriesReplaceAllMetadata').checked;

                    ApiClient.updatePluginConfiguration(RefreshSparseConfig.pluginUniqueId, config).then(function (result) {
                        Dashboard.processPluginConfigurationUpdateResult(result);
                    });
                });

                e.preventDefault();
                return false;
            });
        </script>
    </div>
</body>
</html>
